<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sudoku — 즐겨요 원페이지 | sudoku.enjoy-onepage.com</title>
  <meta name="description" content="빠르고 깔끔한 스도쿠. 오프라인에서도 부드럽게, 해답 유일성 보장 생성기 탑재. 난이도별 퍼즐, 타이머, 오류 체크, 공유까지 한 페이지로!" />
  <link rel="canonical" href="https://sudoku.enjoy-onepage.com/" />
  <meta name="robots" content="index,follow" />
  <meta name="theme-color" content="#38bdf8" />

  <!-- Open Graph / Twitter -->
  <meta property="og:locale" content="ko_KR" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Sudoku — 즐겨요 원페이지" />
  <meta property="og:title" content="Sudoku — 원페이지 퍼즐" />
  <meta property="og:description" content="난이도별 스도쿠를 한 페이지에서. 해답 유일성 보장, 가벼운 인터페이스." />
  <meta property="og:url" content="https://sudoku.enjoy-onepage.com/" />
  <meta property="og:image" content="/og-image.png" />
  <meta property="og:image:alt" content="Sudoku one-page preview" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Sudoku — 원페이지 퍼즐" />
  <meta name="twitter:description" content="난이도별 스도쿠를 한 페이지에서. 해답 유일성 보장, 가벼운 인터페이스." />
  <meta name="twitter:image" content="/og-image.png" />

  <!-- Icons -->
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180" />

  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2228289204702106" crossorigin="anonymous"></script>
  <!-- Kakao SDK -->
  <script src="https://developers.kakao.com/sdk/js/kakao.min.js" defer></script>

  <style>
    :root{
      --bg:#f0f9ff;
      --card:#ffffff;
      --muted:#64748b;
      --fg:#1e293b;
      --accent:#38bdf8;
      --danger:#ef4444;
      --grid:#cbd5e1;
      --grid-strong:#475569;
      --cell:#f8fafc;
      --hl:#eaf6ff;
      --same:#fff1b9;
      --sel:#bae6fd;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--fg); background:var(--bg);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans KR, Apple SD Gothic Neo, Helvetica, Arial;
      -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
      writing-mode: horizontal-tb;
    }
    a{color:inherit}
    .wrap{max-width:1100px; margin:0 auto; padding:24px;}

    header{display:flex; align-items:center; justify-content:space-between; gap:16px; padding:16px; border-radius:16px; background:#e0f2fe; border:1px solid #bae6fd;}
    .brand{display:flex; gap:12px; align-items:center}
    .logo{width:40px; height:40px; border-radius:12px; background:#38bdf8 url('/favicon.png') center/cover no-repeat; box-shadow:0 4px 12px rgba(56,189,248,.35)}
    .title{display:flex; flex-direction:column}
    .title h1{font-size:20px; margin:0; color:#0284c7; letter-spacing:.2px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
    .title p{margin:2px 0 0; color:var(--muted); font-size:12px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}

    .share{display:flex; gap:8px; align-items:center}
    .btn{border:1px solid #bae6fd; background:#f0f9ff; color:var(--fg); padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:600; transition:.2s;}
    .btn:hover{background:#bae6fd}
    .btn.accent{background:var(--accent); color:white; border-color:transparent}
    .btn{writing-mode: horizontal-tb !important; white-space:nowrap; word-break:keep-all;}

    main{display:grid; grid-template-columns: 1fr; gap:16px; margin-top:16px}
    .ad{display:flex; justify-content:center; align-items:center; background:#e0f2fe; border:1px dashed #bae6fd; border-radius:12px; padding:6px; min-height:0;}

    .board-wrap{display:grid; grid-template-columns: 1fr 340px; gap:16px}
    @media (max-width:980px){ .board-wrap{ grid-template-columns: 1fr; } }

    .card{background:var(--card); border:1px solid #e2e8f0; border-radius:16px; padding:16px}
    .controls{display:flex; flex-wrap:wrap; gap:8px; margin-bottom:12px}
    .controls .btn{height:36px}
    select{height:36px; border-radius:10px; background:#f0f9ff; border:1px solid #bae6fd; padding:0 10px}

    .grid{display:grid; grid-template-columns: repeat(9, 1fr); border:3px solid var(--grid-strong); border-radius:12px; overflow:hidden; width:clamp(320px, 92vw, 520px); margin:12px auto;}
    .cell{position:relative; border:1px solid var(--grid);}
    .cell::before{content:""; display:block; padding-bottom:100%;}
    .cell input{position:absolute; inset:0; width:100%; height:100%; border:0; background:transparent; text-align:center; font-weight:700; font-size:clamp(16px, 3.5vw, 28px); color:var(--fg);}
    .cell input:disabled{color:#0284c7}

    .stats{display:grid; grid-template-columns:1fr 1fr; gap:8px}
    .stat{background:#f8fafc; border:1px solid #e2e8f0; border-radius:12px; padding:12px}
    .stat h3{margin:0 0 6px; font-size:12px; color:var(--muted)}
    .stat p{margin:0; font-size:18px; font-weight:800}

    .keypad{display:none; grid-template-columns:repeat(10,1fr); gap:8px; margin-top:12px}
    .keypad .btn{height:44px; font-size:16px; min-width:36px;}
    @media (max-width:980px){ .keypad{display:grid;} }
    @media (max-width:480px){ .share{flex-direction:column; align-items:flex-end; gap:6px;} }

    footer{margin:24px 0 8px; color:var(--muted); font-size:12px; text-align:center}
    .links{display:flex; justify-content:center; gap:12px; margin-top:6px}

    .modal{position:fixed; inset:0; display:none; place-items:center; background:rgba(2,6,23,.55); z-index:50}
    .modal .box{background:#fff; border-radius:16px; padding:20px 18px; width:min(92vw,420px); box-shadow:0 20px 50px rgba(2,6,23,.25)}
    .modal h2{margin:0 0 6px; font-size:20px; color:#0f172a}
    .modal p{margin:0 0 12px; color:#334155}
    .modal .row{display:flex; gap:8px; flex-wrap:wrap}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo"></div>
        <div class="title">
          <h1>Sudoku — 즐겨요 원페이지</h1>
          <p>상큼하고 깔끔한 스도쿠 · 유일해 보장 생성기</p>
        </div>
      </div>
      <div class="share">
        <button class="btn" id="btnShare">공유</button>
        <button class="btn" id="btnKakao">카카오톡 공유</button>
        <a class="btn accent" href="/">홈</a>
      </div>
    </header>

    <!-- 상단 광고 -->
    <div class="ad card">
      <ins class="adsbygoogle" style="display:block"
           data-ad-client="ca-pub-2228289204702106"
           data-ad-slot="7464033680"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
    </div>

    <main>
      <div class="board-wrap">
        <section class="card">
          <div class="controls">
            <select id="level">
              <option value="easy">쉬움</option>
              <option value="medium">보통</option>
              <option value="hard">어려움</option>
            </select>
            <button class="btn" id="btnNew">새 퍼즐</button>
            <button class="btn" id="btnCheck">오류 체크</button>
            <button class="btn" id="btnSolve">해답 보기</button>
            <button class="btn" id="btnReset">초기화</button>
            <button class="btn" id="btnNotes">연필 모드: 끔</button>
          </div>

          <!-- 본문 광고 -->
          <div class="ad">
            <ins class="adsbygoogle" style="display:block"
                 data-ad-client="ca-pub-2228289204702106"
                 data-ad-slot="6150952012"
                 data-ad-format="rectangle"
                 data-full-width-responsive="true"></ins>
            <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
          </div>

          <div id="grid" class="grid"></div>

          <div class="keypad">
            <button class="btn" data-key="1">1</button>
            <button class="btn" data-key="2">2</button>
            <button class="btn" data-key="3">3</button>
            <button class="btn" data-key="4">4</button>
            <button class="btn" data-key="5">5</button>
            <button class="btn" data-key="6">6</button>
            <button class="btn" data-key="7">7</button>
            <button class="btn" data-key="8">8</button>
            <button class="btn" data-key="9">9</button>
            <button class="btn" data-key="del">지우기</button>
          </div>
        </section>

        <aside class="side">
          <section class="card stats">
            <div class="stat"><h3>난이도</h3><p id="statLevel">쉬움</p></div>
            <div class="stat"><h3>타이머</h3><p id="statTimer">00:00</p></div>
            <div class="stat"><h3>남은 칸</h3><p id="statEmpty">0</p></div>
            <div class="stat"><h3>오류 수</h3><p id="statErrors">0</p></div>
          </section>
          <section class="card">
            <h2 style="margin-top:0; font-size:16px">도움말</h2>
            <p style="color:var(--muted); line-height:1.6">
              같은 행, 같은 열, 같은 3×3 박스 안에는 1~9가 한 번씩만 들어갈 수 있어요.<br>
              연필 모드를 켜면 후보 숫자를 메모할 수 있습니다.
            </p>
          </section>
          <section class="card ad">
            <ins class="adsbygoogle" style="display:block"
                 data-ad-client="ca-pub-2228289204702106"
                 data-ad-slot="3524788673"
                 data-ad-format="rectangle"
                 data-full-width-responsive="true"></ins>
            <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
          </section>
        </aside>
      </div>
    </main>

    <footer>
      <div>© <span id="year"></span> sudoku.enjoy-onepage.com</div>
      <div class="links">
        <a href="#">개인정보 처리방침</a><span>·</span><a href="#">문의</a>
      </div>
    </footer>
  </div>

  <!-- 완료 모달 -->
  <div id="winModal" class="modal">
    <div class="box">
      <h2>🎉 축하합니다!</h2>
      <p id="winText">퍼즐을 완성했어요.</p>
      <div class="row">
        <button class="btn accent" id="btnAgain">다시 풀기</button>
        <button class="btn" id="btnShareWin">공유</button>
        <button class="btn" id="btnKakaoWin">카카오톡</button>
      </div>
    </div>
  </div>

<script>
  // Kakao init
  window.addEventListener('DOMContentLoaded', () => {
    try{ if(window.Kakao && !Kakao.isInitialized()) Kakao.init('b157f51afb710d60c8b6bec3dc9a2d1f'); }catch(e){}
  });

  // ===== Sudoku Core =====
  const rowIdx=i=>Math.floor(i/9), colIdx=i=>i%9, boxIdx=(r,c)=>Math.floor(r/3)*3+Math.floor(c/3);
  const shuffle=a=>a.sort(()=>Math.random()-0.5);
  function generateSolvedGrid(){ const g=new Array(81).fill(0); const r=Array.from({length:9},()=>new Set()), c=Array.from({length:9},()=>new Set()), b=Array.from({length:9},()=>new Set()); const nums=[1,2,3,4,5,6,7,8,9]; function place(i=0){ if(i===81) return true; const R=rowIdx(i),C=colIdx(i),B=boxIdx(R,C); for(const v of shuffle(nums.slice())){ if(!r[R].has(v)&&!c[C].has(v)&&!b[B].has(v)){ g[i]=v; r[R].add(v); c[C].add(v); b[B].add(v); if(place(i+1)) return true; g[i]=0; r[R].delete(v); c[C].delete(v); b[B].delete(v);} } return false;} place(); return g; }
  function countSolutions(p,limit=2){ const g=p.slice(); let sol=0; function candAt(i){ const R=rowIdx(i),C=colIdx(i),u=new Set(); for(let k=0;k<9;k++){u.add(g[R*9+k]);u.add(g[k*9+C]);} const br=Math.floor(R/3)*3,bc=Math.floor(C/3)*3; for(let rr=0;rr<3;rr++)for(let cc=0;cc<3;cc++)u.add(g[(br+rr)*9+(bc+cc)]); const res=[]; for(let v=1;v<=9;v++)if(!u.has(v))res.push(v); return res;} function best(){ let best=-1,cand=null; for(let i=0;i<81;i++)if(g[i]===0){ const c=candAt(i); if(c.length===0) return {i,c:[]}; if(!cand||c.length<cand.length){best=i;cand=c;} } return {i:best,c:cand}; } function dfs(){ if(sol>=limit) return; const {i,c}=best(); if(i===-1){sol++;return;} for(const v of c){g[i]=v;dfs();g[i]=0;if(sol>=limit)return;} } dfs(); return sol;}
  const DIFF={easy:40,medium:32,hard:26};
  function makePuzzle(solved,clues){ const p=solved.slice(), ord=shuffle([...Array(81).keys()]); let left=81; for(const i of ord){ if(left<=clues) break; const bak=p[i]; p[i]=0; if(countSolutions(p,2)!==1){p[i]=bak;} else left--; } return p; }

  const state={puzzle:[],solved:[],fixed:[],won:false,revealed:false,startTs:null,timer:null};
  const gridEl=document.getElementById('grid'), cells=[]; let select=null;