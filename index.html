<!doctype html>

<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sudoku — 즐겨요 원페이지 | sudoku.enjoy-onepage.com</title>
  <meta name="description" content="빠르고 깔끔한 스도쿠. 오프라인에서도 부드럽게, 해답 유일성 보장 생성기 탑재. 난이도별 퍼즐, 타이머, 오류 체크, 공유까지 한 페이지로!" />
  <link rel="canonical" href="https://sudoku.enjoy-onepage.com/" />
  <meta name="robots" content="index,follow" />
  <meta name="theme-color" content="#38bdf8" />  <!-- Open Graph / Kakao / SNS Preview -->  <meta property="og:locale" content="ko_KR" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Sudoku — 즐겨요 원페이지" />
  <meta property="og:title" content="Sudoku — 원페이지 퍼즐" />
  <meta property="og:description" content="난이도별 스도쿠를 한 페이지에서. 해답 유일성 보장, 가벼운 인터페이스." />
  <meta property="og:url" content="https://sudoku.enjoy-onepage.com/" />
  <meta property="og:image" content="/og-image.png" />
  <meta property="og:image:alt" content="Sudoku one-page preview" />  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Sudoku — 원페이지 퍼즐" />
  <meta name="twitter:description" content="난이도별 스도쿠를 한 페이지에서. 해답 유일성 보장, 가벼운 인터페이스." />
  <meta name="twitter:image" content="/og-image.png" />  <!-- Icons -->  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180" />  <!-- Google AdSense (제공하신 client/slot 사용) -->  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2228289204702106" crossorigin="anonymous"></script>  <!-- Kakao SDK -->  <script src="https://developers.kakao.com/sdk/js/kakao.min.js" defer></script>  <style>
    :root{
      --bg:#f0f9ff;        /* 밝은 하늘색 배경 */
      --card:#ffffff;      /* 흰색 카드 */
      --muted:#64748b;     /* slate-500 */
      --fg:#1e293b;        /* slate-800 */
      --accent:#38bdf8;    /* sky-400 */
      --accent-2:#22c55e;  /* green-500 */
      --danger:#ef4444;    /* red-500 */
      --grid:#cbd5e1;      /* 얇은 선 */
      --grid-strong:#475569;/* 굵은 선 */
      --cell:#f8fafc;      /* 칸 배경 */
      --hl:#eaf6ff;        /* 행/열/박스 하이라이트 */
      --same:#fff1b9;      /* 같은 숫자 하이라이트(레몬) */
      --sel:#bae6fd;       /* 선택 칸 배경 */
      --focus-ring:#38bdf8;/* 키보드 포커스 */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--fg); background:var(--bg);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans KR, Apple SD Gothic Neo, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
    }
    a{color:inherit}
    .wrap{max-width:1100px; margin:0 auto; padding:24px;}

    header{display:flex; align-items:center; justify-content:space-between; gap:16px; padding:16px; border-radius:16px; background:#e0f2fe; border:1px solid #bae6fd;}
    .brand{display:flex; gap:12px; align-items:center}
    .logo{width:40px; height:40px; border-radius:12px; background:#38bdf8 url('/favicon.png') center/cover no-repeat; box-shadow:0 4px 12px rgba(56,189,248,.35)}
    .title{display:flex; flex-direction:column}
    .title h1{font-size:20px; margin:0; color:#0284c7; letter-spacing:.2px}
    .title p{margin:2px 0 0; color:var(--muted); font-size:12px}

    .share{display:flex; gap:8px; align-items:center}
    .btn{border:1px solid #bae6fd; background:#f0f9ff; color:var(--fg); padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:600; transition: all .2s ease;}
    .btn:hover{background:#bae6fd}
    .btn.accent{background:var(--accent); color:white; border-color:transparent}

    main{display:grid; grid-template-columns: 1fr; gap:16px; margin-top:16px}

    /* 광고 박스 (검수 전 시각 가이드) */
    .ad{display:flex; justify-content:center; align-items:center; background:#e0f2fe; border:1px dashed #bae6fd; border-radius:12px; padding:8px}

    .board-wrap{display:grid; grid-template-columns: 1fr 340px; gap:16px}
    @media (max-width:980px){ .board-wrap{ grid-template-columns: 1fr; } }

    .card{background:var(--card); border:1px solid #e2e8f0; border-radius:16px; padding:16px}
    .controls{display:flex; flex-wrap:wrap; gap:8px; margin-bottom:12px}
    .controls .btn{height:36px}
    select{height:36px; border-radius:10px; background:#f0f9ff; color:var(--fg); border:1px solid #bae6fd; padding:0 10px}

    /* === 균일한 보드 테두리 === */
    .grid{display:grid; grid-template-columns: repeat(9, 1fr); border:3px solid var(--grid-strong); border-radius:12px; overflow:hidden}
    .cell{aspect-ratio:1/1; background:var(--cell); border:1px solid var(--grid); position:relative}
    .cell input{width:100%; height:100%; background:transparent; border:0; color:var(--fg); text-align:center; font-weight:800; letter-spacing:.5px; font-size:clamp(18px, 3.5vw, 28px); outline:none; caret-color:transparent}
    .cell input:disabled{color:#0284c7}
    .cell.error input{color:var(--danger)}

    /* 3x3 굵은선 */
    .cell:nth-child(3n){border-right:3px solid var(--grid-strong)}
    .cell:nth-child(9n+1){border-left:3px solid var(--grid-strong)}
    .cell:nth-child(n+1):nth-child(-n+9){border-top:3px solid var(--grid-strong)}
    .cell:nth-child(n+73):nth-child(-n+81){border-bottom:3px solid var(--grid-strong)}
    .cell:nth-child(n+19):nth-child(-n+27),
    .cell:nth-child(n+46):nth-child(-n+54){border-bottom:3px solid var(--grid-strong)}

    /* 하이라이트 */
    .cell.hl{background:var(--hl)}
    .cell.same{background:var(--same)}
    .cell.sel{background:var(--sel); outline:2px solid var(--accent); outline-offset:-2px}

    /* 사이드 정보 */
    .stats{display:grid; grid-template-columns: 1fr 1fr; gap:8px}
    .stat{background:#f8fafc; border:1px solid #e2e8f0; border-radius:12px; padding:12px}
    .stat h3{margin:0 0 6px; font-size:12px; color:var(--muted)}
    .stat p{margin:0; font-size:18px; font-weight:800}

    /* 모바일 전용 키패드: 작은 화면에서만 노출 */
    .keypad{display:none; grid-template-columns:repeat(10,1fr); gap:8px; margin-top:12px}
    .keypad .btn{height:44px; font-size:16px; background:#f0f9ff}
    @media (max-width:980px){ .keypad{display:grid;} }

    footer{margin:24px 0 8px; color:var(--muted); font-size:12px; text-align:center}
    .links{display:flex; justify-content:center; gap:12px; margin-top:6px}

    /* 완료 모달 */
    .modal{position:fixed; inset:0; display:none; place-items:center; background:rgba(2,6,23,.55); z-index:50}
    .modal .box{background:#fff; border-radius:16px; padding:20px 18px; width:min(92vw, 420px); box-shadow:0 20px 50px rgba(2,6,23,.25)}
    .modal h2{margin:0 0 6px; font-size:20px; color:#0f172a}
    .modal p{margin:0 0 12px; color:#334155}
    .modal .row{display:flex; gap:8px; flex-wrap:wrap}
  </style></head>
<body>
  <div class="wrap">
    <header aria-label="사이트 헤더">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div class="title">
          <h1>Sudoku — 즐겨요 원페이지</h1>
          <p>상큼하고 깔끔한 스도쿠 · 유일해 보장 생성기</p>
        </div>
      </div>
      <div class="share">
        <button class="btn" id="btnShare">공유</button>
        <button class="btn" id="btnKakao">카카오톡 공유</button>
        <a class="btn accent" href="https://sudoku.enjoy-onepage.com/">홈</a>
      </div>
    </header><!-- Top Leaderboard Ad -->
<div class="ad card" aria-label="광고 영역 상단">
  <ins class="adsbygoogle" style="display:block"
       data-ad-client="ca-pub-2228289204702106"
       data-ad-slot="7464033680"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
</div>

<main>
  <div class="board-wrap">
    <section class="card">
      <div class="controls" role="group" aria-label="게임 컨트롤">
        <label for="level" class="sr-only" style="position:absolute;left:-9999px">난이도</label>
        <select id="level" aria-label="난이도">
          <option value="easy">쉬움</option>
          <option value="medium">보통</option>
          <option value="hard">어려움</option>
        </select>
        <button class="btn" id="btnNew">새 퍼즐</button>
        <button class="btn" id="btnCheck">오류 체크</button>
        <button class="btn" id="btnSolve">해답 보기</button>
        <button class="btn" id="btnReset">초기화</button>
        <button class="btn" id="btnNotes">연필 모드: 끔</button>
      </div>

      <!-- In-content Ad (보드 위/아래 위치 가능) -->
      <div class="ad" aria-label="광고 영역 본문">
        <ins class="adsbygoogle" style="display:block"
             data-ad-client="ca-pub-2228289204702106"
             data-ad-slot="6150952012"
             data-ad-format="rectangle, horizontal"
             data-full-width-responsive="true"></ins>
        <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
      </div>

      <div id="grid" class="grid" aria-label="스도쿠 보드"></div>

      <!-- 모바일 전용 가상 숫자 키패드 -->
      <div class="keypad" aria-label="숫자 키패드">
        <button class="btn" data-key="1">1</button>
        <button class="btn" data-key="2">2</button>
        <button class="btn" data-key="3">3</button>
        <button class="btn" data-key="4">4</button>
        <button class="btn" data-key="5">5</button>
        <button class="btn" data-key="6">6</button>
        <button class="btn" data-key="7">7</button>
        <button class="btn" data-key="8">8</button>
        <button class="btn" data-key="9">9</button>
        <button class="btn" data-key="del">지우기</button>
      </div>
    </section>

    <aside class="side">
      <section class="card stats" aria-label="상태 표시">
        <div class="stat"><h3>난이도</h3><p id="statLevel">쉬움</p></div>
        <div class="stat"><h3>타이머</h3><p id="statTimer">00:00</p></div>
        <div class="stat"><h3>남은 칸</h3><p id="statEmpty">0</p></div>
        <div class="stat"><h3>오류 수</h3><p id="statErrors">0</p></div>
      </section>
      <section class="card" aria-label="도움말">
        <h2 style="margin-top:0; font-size:16px">도움말</h2>
        <p style="color:var(--muted); line-height:1.6">
          같은 행, 같은 열, 같은 3×3 박스 안에는 1~9가 한 번씩만 들어갈 수 있어요.
          연필 모드를 켜면 후보 숫자를 메모할 수 있습니다.
        </p>
      </section>
      <!-- Side Ad (medium rectangle) -->
      <section class="card ad" aria-label="광고 영역 사이드">
        <ins class="adsbygoogle" style="display:block"
             data-ad-client="ca-pub-2228289204702106"
             data-ad-slot="3524788673"
             data-ad-format="rectangle"
             data-full-width-responsive="true"></ins>
        <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
      </section>
    </aside>
  </div>
</main>

<footer>
  <div>© <span id="year"></span> sudoku.enjoy-onepage.com</div>
  <div class="links">
    <a href="#" aria-label="개인정보 처리방침">개인정보 처리방침</a>
    <span>·</span>
    <a href="#" aria-label="문의">문의</a>
  </div>
</footer>

  </div>  <!-- 완료 모달 -->  <div id="winModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="winTitle">
    <div class="box">
      <h2 id="winTitle">🎉 축하합니다!</h2>
      <p id="winText">퍼즐을 완성했어요.</p>
      <div class="row">
        <button class="btn accent" id="btnAgain">다시 풀기</button>
        <button class="btn" id="btnShareWin">공유</button>
        <button class="btn" id="btnKakaoWin">카카오톡</button>
      </div>
    </div>
  </div>  <script>
    // ===== Kakao init (제공 키 사용) =====
    window.addEventListener('DOMContentLoaded', () => {
      try { if (window.Kakao && !Kakao.isInitialized()) Kakao.init('b157f51afb710d60c8b6bec3dc9a2d1f'); } catch(e){}
    });

    // ===== Seeded RNG (공유용 시드) =====
    function mulberry32(a){ return function(){ let t=a+=0x6D2B79F5; t=Math.imul(t^t>>>15, t|1); t^=t+Math.imul(t^t>>>7, t|61); return ((t^t>>>14)>>>0)/4294967296; }; }
    function strToSeed(s){ let h=0; for(let i=0;i<s.length;i++){ h=((h<<5)-h + s.charCodeAt(i))|0; } return (h>>>0); }
    const url = new URL(location.href);
    const seedParam = url.searchParams.get('seed');
    const diffParam = url.searchParams.get('d') || 'easy';
    const seedValue = seedParam ? ( /^\d+$/.test(seedParam) ? Number(seedParam) : strToSeed(seedParam) ) : (Math.random()*1e9|0);
    let rng = mulberry32(seedValue);
    const RNG = () => rng();
    const shuffle = arr => arr.sort(() => RNG() - 0.5);
    const rowIdx = i => Math.floor(i/9); const colIdx = i => i%9; const boxIdx = (r,c)=>Math.floor(r/3)*3+Math.floor(c/3);

    // ===== Generator: solved grid via backtracking =====
    function generateSolvedGrid(){
      const grid = new Array(81).fill(0);
      const rows = Array.from({length:9},()=>new Set());
      const cols = Array.from({length:9},()=>new Set());
      const boxes = Array.from({length:9},()=>new Set());
      const nums = [1,2,3,4,5,6,7,8,9];
      function place(i=0){
        if(i===81) return true;
        const r=rowIdx(i), c=colIdx(i), b=boxIdx(r,c);
        const order=shuffle(nums.slice());
        for(const v of order){
          if(!rows[r].has(v)&&!cols[c].has(v)&&!boxes[b].has(v)){
            grid[i]=v; rows[r].add(v); cols[c].add(v); boxes[b].add(v);
            if(place(i+1)) return true;
            grid[i]=0; rows[r].delete(v); cols[c].delete(v); boxes[b].delete(v);
          }
        }
        return false;
      }
      place(0); return grid;
    }

    // ===== Solver: count solutions (for uniqueness) =====
    function countSolutions(puzzle, limit=2){
      const grid=puzzle.slice(); let solutions=0;
      function candidatesAt(i){
        const r=rowIdx(i), c=colIdx(i);
        const used=new Set();
        for(let k=0;k<9;k++){ used.add(grid[r*9+k]); used.add(grid[k*9+c]); }
        const br=Math.floor(r/3)*3, bc=Math.floor(c/3)*3;
        for(let rr=0; rr<3; rr++) for(let cc=0; cc<3; cc++){ used.add(grid[(br+rr)*9+(bc+cc)]); }
        const cand=[]; for(let v=1; v<=9; v++) if(!used.has(v)) cand.push(v); return cand;
      }
      function bestEmpty(){
        let best=-1, bestCand=null;
        for(let i=0;i<81;i++) if(grid[i]===0){
          const cand=candidatesAt(i); if(cand.length===0) return {i, cand:[]};
          if(!bestCand||cand.length<bestCand.length){ best=i; bestCand=cand; if(cand.length===1) break; }
        }
        return {i:best, cand:bestCand};
      }
      function dfs(){
        if(solutions>=limit) return;
        const {i, cand}=bestEmpty();
        if(i===-1){ solutions++; return; }
        for(const v of cand){ grid[i]=v; dfs(); grid[i]=0; if(solutions>=limit) return; }
      }
      dfs(); return solutions;
    }

    // ===== Puzzle maker: remove clues while unique =====
    const DIFF = { easy:40, medium:32, hard:26 };
    function makePuzzleFromSolved(solved, targetClues){
      const puzzle=solved.slice(); const order=shuffle([...Array(81).keys()]); let clues=81;
      for(const i of order){ if(clues<=targetClues) break; const b=puzzle[i]; puzzle[i]=0; if(countSolutions(puzzle,2)!==1){ puzzle[i]=b; } else { clues--; } }
      return puzzle;
    }

    // ===== State =====
    const state={
      fixed:new Array(81).fill(false),
      notes:new Array(81).fill(0).map(()=>new Set()),
      puzzle:new Array(81).fill(0),
      solved:new Array(81).fill(0),
      initialPuzzle:new Array(81).fill(0),
      initialFixed:new Array(81).fill(false),
      noteMode:false,
      startTs:null, timerId:null,
      won:false,
      revealed:false,
    };

    // ===== UI =====
    const gridEl=document.getElementById('grid');
    const levelEl=document.getElementById('level');
    const statLevel=document.getElementById('statLevel');
    const statTimer=document.getElementById('statTimer');
    const statEmpty=document.getElementById('statEmpty');
    const statErrors=document.getElementById('statErrors');
    const cells=[]; let selectIdx=null;

    for(let r=0;r<9;r++){
      for(let c=0;c<9;c++){
        const i=r*9+c;
        const cell=document.createElement('div'); cell.className='cell';
        const input=document.createElement('input'); input.inputMode='numeric'; input.maxLength=1; input.setAttribute('aria-label',`r${r+1} c${c+1}`);
        cell.appendChild(input); gridEl.appendChild(cell);
        cells.push({cell,input});
        cell.addEventListener('click',()=>{ selectIdx=i; input.focus(); updateHighlight(); });
        input.addEventListener('focus',()=>{ selectIdx=i; updateHighlight(); });
        input.addEventListener('input',()=>onInput(i,input.value));
        input.addEventListener('keydown',e=>{
          if(['Backspace','Delete','0'].includes(e.key)){ setValue(i,0); e.preventDefault(); return; }
          const move={ArrowUp:-9, ArrowDown:9, ArrowLeft:-1, ArrowRight:1}[e.key];
          if(move){ e.preventDefault(); moveSelect(move); }
        });
      }
    }

    function moveSelect(delta){ if(selectIdx==null) return; const n=(selectIdx+delta+81)%81; selectIdx=n; cells[n].input.focus(); updateHighlight(); }

    // 모바일 키패드
    document.querySelectorAll('.keypad .btn').forEach(btn=>{
      btn.addEventListener('click',()=>{
        const key = btn.dataset.key;
        if(navigator.vibrate) try{ navigator.vibrate(12); }catch(e){}
        if(selectIdx==null){ const firstEmpty = state.puzzle.findIndex(v=>v===0); selectIdx = firstEmpty>=0 ? firstEmpty : 0; cells[selectIdx].input.focus(); }
        if(key==='del'){ setValue(selectIdx,0); updateHighlight(); return; }
        setValue(selectIdx, key);
        // 다음 빈 칸으로 이동
        let next = selectIdx;
        for(let k=1;k<=81;k++){
          const i=(selectIdx+k)%81; if(!state.fixed[i] && state.puzzle[i]===0){ next=i; break; }
        }
        selectIdx = next; cells[selectIdx].input.focus(); updateHighlight();
      });
    });

    // ===== Rendering =====
    function render(){
      let empty=0, errors=0;
      for(let i=0;i<81;i++){
        const {cell,input}=cells[i];
        const v=state.puzzle[i]; const isFixed=state.fixed[i];
        input.disabled=isFixed; input.value=v?String(v):'';
        const err = v && state.solved[i]!==v && !isFixed; 
        cell.classList.toggle('error', err);
        if(!v) empty++; if(err) errors++;
      }
      statEmpty.textContent=String(empty);
      statErrors.textContent=String(errors);
      updateHighlight();
      checkWin();
    }

    function setValue(i,val){
      if(state.fixed[i]) return;
      const n=Number(val)||0; if(n<0||n>9) return;
      if(state.noteMode && n!==0){ /* 메모 모드 생략 구현 */ }
      else { state.puzzle[i]=n; }
      saveLocal(); render();
    }

    function onInput(i,raw){ const n=Number(raw.replace(/[^1-9]/g,'')); setValue(i, isNaN(n)?0:n); }
    function toggleNotes(){ state.noteMode=!state.noteMode; document.getElementById('btnNotes').textContent='연필 모드: '+(state.noteMode?'켬':'끔'); render(); }
    function checkErrors(){ render(); flash('오류를 표시했어요'); }
    function showSolution(){
      // 해답 보기 시에는 축하 모달이 뜨지 않도록 플래그 설정
      state.revealed = true;
      state.puzzle = state.solved.slice();
      for(let i=0;i<81;i++) state.fixed[i] = true;
      saveLocal();
      render();
      stopTimer();
      flash('해답을 표시했어요');
    }
    function resetBoard(){
      state.puzzle=state.initialPuzzle.slice();
      state.fixed=state.initialFixed.slice();
      state.revealed=false; state.revealed=false; state.won=false;
      saveLocal(); render(); startTimer();
    }

    function newGame(level='easy'){
      // URL에 시드/난이도 기록 (재현/공유)
      const useSeed = seedParam ?? (Math.random()*1e9|0).toString();
      const useDiff = level || 'easy';
      const u = new URL(location.href); u.searchParams.set('seed', useSeed); u.searchParams.set('d', useDiff); history.replaceState({}, '', u.toString());
      // 시드 재설정
      const sv = /^\d+$/.test(useSeed) ? Number(useSeed) : strToSeed(useSeed);
      rng = mulberry32(sv);

      const solved=generateSolvedGrid();
      const target=DIFF[useDiff]||DIFF.easy;
      const puzzle=makePuzzleFromSolved(solved, target);
      state.solved=solved; state.puzzle=puzzle; state.fixed=puzzle.map(v=>v!==0);
      state.initialPuzzle=puzzle.slice(); state.initialFixed=state.fixed.slice();
      state.revealed=false; state.won=false;
      statLevel.textContent = levelEl.options[levelEl.selectedIndex]?.textContent || '쉬움';
      saveLocal(); render(); startTimer();
    }

    // 하이라이트
    function updateHighlight(){
      const N=81; for(let i=0;i<N;i++){ cells[i].cell.classList.remove('sel','hl','same'); }
      if(selectIdx==null) return;
      const r=rowIdx(selectIdx), c=colIdx(selectIdx);
      for(let i=0;i<81;i++){
        const rr=rowIdx(i), cc=colIdx(i);
        if(rr===r || cc===c || (Math.floor(rr/3)===Math.floor(r/3) && Math.floor(cc/3)===Math.floor(c/3))){
          cells[i].cell.classList.add('hl');
        }
      }
      cells[selectIdx].cell.classList.add('sel');
      const v = state.puzzle[selectIdx];
      if(v){ for(let i=0;i<81;i++){ if(state.puzzle[i]===v) cells[i].cell.classList.add('same'); } }
    }

    // 완료 체크
    function checkWin(){
      // 해답 보기로 채운 상태(revealed)는 승리로 처리하지 않음
      if(state.won || state.revealed) return;
      for(let i=0;i<81;i++){ if(!state.puzzle[i] || state.puzzle[i]!==state.solved[i]) return; }
      state.won = true; stopTimer();
      const sec=Math.floor((Date.now()-state.startTs)/1000);
      document.getElementById('winText').textContent = `난이도: ${levelEl.options[levelEl.selectedIndex].textContent} · 시간: ${fmtTime(sec)}`;
      document.getElementById('winModal').style.display='grid';
    }
      state.won = true; stopTimer();
      const sec=Math.floor((Date.now()-state.startTs)/1000);
      document.getElementById('winText').textContent = `난이도: ${levelEl.options[levelEl.selectedIndex].textContent} · 시간: ${fmtTime(sec)}`;
      document.getElementById('winModal').style.display='grid';
    }

    document.getElementById('btnAgain').onclick=()=>{ document.getElementById('winModal').style.display='none'; newGame(levelEl.value); };

    // 공유 (Web Share API + Kakao)
    async function shareNative(){
      const data={ title:'Sudoku — 즐겨요 원페이지', text:'가볍고 빠른 스도쿠. 유일해 보장 생성기 탑재!', url: location.href };
      if(navigator.share){ try{ await navigator.share(data); } catch(e){} }
      else { await navigator.clipboard.writeText(location.href); flash('링크를 복사했어요'); }
    }
    function shareKakao(){
      try{
        if(!window.Kakao){ flash('Kakao SDK 로딩 중입니다'); return; }
        Kakao.Share.sendDefault({
          objectType:'feed',
          content:{ title:'Sudoku — 즐겨요 원페이지', description:'가볍고 빠른 스도쿠. 유일해 보장 생성기 탑재!', imageUrl: location.origin+'/og-image.png', link:{ mobileWebUrl:location.href, webUrl:location.href } },
          buttons:[ { title:'지금 풀기', link:{ mobileWebUrl:location.href, webUrl:location.href } } ]
        });
      }catch(e){ flash('카카오톡 공유를 사용할 수 없어요'); }
    }

    document.getElementById('btnShare').onclick=shareNative;
    document.getElementById('btnKakao').onclick=shareKakao;
    document.getElementById('btnShareWin').onclick=shareNative;
    document.getElementById('btnKakaoWin').onclick=shareKakao;

    // Timer & helpers
    function startTimer(){ state.startTs=Date.now(); if(state.timerId) clearInterval(state.timerId); state.timerId=setInterval(updateTimer,1000); updateTimer(); }
    function stopTimer(){ if(state.timerId) clearInterval(state.timerId); state.timerId=null; }
    function updateTimer(){ if(!state.startTs) return; const s=Math.floor((Date.now()-state.startTs)/1000); statTimer.textContent = fmtTime(s); }
    function fmtTime(s){ const m=Math.floor(s/60), ss=s%60; return `${String(m).padStart(2,'0')}:${String(ss).padStart(2,'0')}`; }

    // LocalStorage
    function saveLocal(){ try{ localStorage.setItem('sudoku_state_v2', JSON.stringify({ ...state, seed:seedValue, diff:levelEl.value })); }catch(e){} }
    function loadLocal(){ try{ const raw=localStorage.getItem('sudoku_state_v2'); if(!raw) return false; const obj=JSON.parse(raw); Object.assign(state, obj, {notes:state.notes}); return true; }catch(e){ return false; } }

    // Boot
    document.getElementById('year').textContent=new Date().getFullYear();
    document.getElementById('level').value = ['easy','medium','hard'].includes(diffParam)? diffParam : 'easy';
    newGame(document.getElementById('level').value);
    document.getElementById('btnNew').onclick=()=>newGame(document.getElementById('level').value);
    document.getElementById('btnCheck').onclick=checkErrors;
    document.getElementById('btnSolve').onclick=showSolution;
    document.getElementById('btnReset').onclick=resetBoard;
    document.getElementById('btnNotes').onclick=toggleNotes;
  </script></body>
</html>
